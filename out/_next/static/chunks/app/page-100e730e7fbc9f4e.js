(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5993:function(e,a,t){Promise.resolve().then(t.bind(t,1603))},1603:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return eK}});var s=t(7437),r=t(2265),n=t(8667),i=t(738),l=t(2148),o=t(5978);let c=(0,i.C6)().length?(0,i.Mq)():(0,i.ZF)({apiKey:"AIzaSyCK8hIlXlzasOsBBW_e2uawuE49O8ECmrY",authDomain:"agenda-citas-cf112.firebaseapp.com",projectId:"agenda-citas-cf112",storageBucket:"agenda-citas-cf112.firebasestorage.app",messagingSenderId:"554106873398",appId:"1:554106873398:web:490688f5de140d787dda97"}),d=(0,l.v0)(c),m=(0,o.ad)(c);var u=t(7053),x=t(535),f=t(4508);let h=(0,x.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p=r.forwardRef((e,a)=>{let{className:t,variant:r,size:n,asChild:i=!1,...l}=e,o=i?u.g7:"button";return(0,s.jsx)(o,{className:(0,f.cn)(h({variant:r,size:n,className:t})),ref:a,...l})});p.displayName="Button";let g=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});g.displayName="Card";let j=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",t),...r})});j.displayName="CardHeader";let N=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});N.displayName="CardTitle";let y=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("text-sm text-muted-foreground",t),...r})});y.displayName="CardDescription";let v=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("p-6 pt-0",t),...r})});v.displayName="CardContent",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,f.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter";var b=t(5153),w=t(1047),E=t(3529);function C(){let[e,a]=(0,r.useState)(!1),{toast:t}=(0,b.pm)(),n=async()=>{a(!0);try{let e=new l.hJ;e.addScope("https://www.googleapis.com/auth/calendar"),await (0,l.rh)(d,e),t({title:"\xa1Bienvenido!",description:"Has iniciado sesi\xf3n correctamente."})}catch(e){console.error("Error al iniciar sesi\xf3n:",e),t({title:"Error",description:"No se pudo iniciar sesi\xf3n. Int\xe9ntalo de nuevo.",variant:"destructive"})}finally{a(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,s.jsxs)(g,{className:"w-full max-w-md",children:[(0,s.jsxs)(j,{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100",children:(0,s.jsx)(w.Z,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsx)(N,{className:"text-2xl",children:"Gestor de Citas"}),(0,s.jsx)(y,{children:"Inicia sesi\xf3n para gestionar tus citas y sincronizar con Google Calendar"})]}),(0,s.jsx)(v,{children:(0,s.jsxs)(p,{onClick:n,disabled:e,className:"w-full",size:"lg",children:[(0,s.jsx)(E.Z,{className:"mr-2 h-4 w-4"}),e?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n con Google"]})})]})})}var T=t(2451),S=t(407),k=t(5981);function _(e){let{className:a,classNames:t,showOutsideDays:r=!0,...n}=e;return(0,s.jsx)(k._W,{showOutsideDays:r,className:(0,f.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,f.cn)(h({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,f.cn)(h({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...a}=e;return(0,s.jsx)(T.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...a}=e;return(0,s.jsx)(S.Z,{className:"h-4 w-4"})}},...n})}_.displayName="Calendar";let Z=(0,x.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function A(e){let{className:a,variant:t,...r}=e;return(0,s.jsx)("div",{className:(0,f.cn)(Z({variant:t}),a),...r})}var z=t(6357),D=t(936),R=t(7107),M=t(3292),I=t(1723),O=t(9345),V=t(3041);function U(e){let{appointments:a,selectedDate:t,onDateSelect:n,onAppointmentClick:i}=e,[l,o]=(0,r.useState)(t),c=l?a.filter(e=>(0,z.K)((0,D.D)(e.date),l)):[],d={hasAppointments:a.map(e=>(0,D.D)(e.date))};return(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)(_,{mode:"single",selected:l,onSelect:e=>{e&&(o(e),n(e))},locale:M.es,modifiers:d,modifiersStyles:{hasAppointments:{backgroundColor:"#dbeafe",color:"#1e40af",fontWeight:"bold"}},className:"rounded-md border"})}),(0,s.jsx)("div",{children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsx)(N,{className:"text-lg",children:l?(0,R.WU)(l,"d 'de' MMMM, yyyy",{locale:M.es}):"Selecciona una fecha"})}),(0,s.jsx)(v,{children:0===c.length?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No hay citas programadas para esta fecha"}):(0,s.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,s.jsxs)("div",{onClick:()=>i(e),className:"p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:e.name}),(0,s.jsxs)(A,{variant:"outline",children:[(0,s.jsx)(I.Z,{className:"h-3 w-3 mr-1"}),e.time]})]}),(0,s.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(O.Z,{className:"h-3 w-3 mr-2"}),e.email]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(V.Z,{className:"h-3 w-3 mr-2"}),e.phone]})]})]},e.id))})})]})})]})}let L=r.forwardRef((e,a)=>{let{className:t,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,f.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...n})});L.displayName="Input";var H=t(6394);let P=(0,x.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),F=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(H.f,{ref:a,className:(0,f.cn)(P(),t),...r})});F.displayName=H.f.displayName;let W=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r})});W.displayName="Textarea";var B=t(2489),G=t(2369),Y=t(8736);function J(e){let{appointment:a,onSave:t,onCancel:n}=e,[i,l]=(0,r.useState)({name:"",email:"",phone:"",date:"",time:"",notes:""}),[o,c]=(0,r.useState)({}),[d,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(a)l({name:a.name,email:a.email,phone:a.phone,date:a.date,time:a.time,notes:a.notes||""});else{let e=new Date;l(a=>({...a,date:(0,R.WU)(e,"yyyy-MM-dd")}))}},[a]);let u=()=>{let e={};if(i.name.trim()||(e.name="El nombre es obligatorio"),i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(e.email="El email no es v\xe1lido"):e.email="El email es obligatorio",i.phone.trim()||(e.phone="El tel\xe9fono es obligatorio"),i.date){let a=new Date(i.date),t=new Date;t.setHours(0,0,0,0),a<t&&(e.date="La fecha no puede ser anterior a hoy")}else e.date="La fecha es obligatoria";return i.time||(e.time="La hora es obligatoria"),c(e),0===Object.keys(e).length},x=async e=>{if(e.preventDefault(),u()){m(!0);try{await t(i)}finally{m(!1)}}},f=(e,a)=>{l(t=>({...t,[e]:a})),o[e]&&c(a=>({...a,[e]:""}))};return(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(N,{className:"flex items-center",children:[(0,s.jsx)(w.Z,{className:"h-5 w-5 mr-2"}),a?"Editar Cita":"Nueva Cita"]}),(0,s.jsx)(p,{variant:"ghost",size:"sm",onClick:n,children:(0,s.jsx)(B.Z,{className:"h-4 w-4"})})]})}),(0,s.jsx)(v,{children:(0,s.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"name",className:"flex items-center",children:[(0,s.jsx)(G.Z,{className:"h-4 w-4 mr-2"}),"Nombre completo"]}),(0,s.jsx)(L,{id:"name",value:i.name,onChange:e=>f("name",e.target.value),placeholder:"Ingresa el nombre completo",className:o.name?"border-red-500":""}),o.name&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:o.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"email",className:"flex items-center",children:[(0,s.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Email"]}),(0,s.jsx)(L,{id:"email",type:"email",value:i.email,onChange:e=>f("email",e.target.value),placeholder:"ejemplo@correo.com",className:o.email?"border-red-500":""}),o.email&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:o.email})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"phone",className:"flex items-center",children:[(0,s.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),"Tel\xe9fono"]}),(0,s.jsx)(L,{id:"phone",value:i.phone,onChange:e=>f("phone",e.target.value),placeholder:"+34 123 456 789",className:o.phone?"border-red-500":""}),o.phone&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:o.phone})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"date",className:"flex items-center",children:[(0,s.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Fecha"]}),(0,s.jsx)(L,{id:"date",type:"date",value:i.date,onChange:e=>f("date",e.target.value),className:o.date?"border-red-500":""}),o.date&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:o.date})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"time",className:"flex items-center",children:[(0,s.jsx)(I.Z,{className:"h-4 w-4 mr-2"}),"Hora"]}),(0,s.jsx)(L,{id:"time",type:"time",value:i.time,onChange:e=>f("time",e.target.value),className:o.time?"border-red-500":""}),o.time&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:o.time})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(F,{htmlFor:"notes",className:"flex items-center",children:[(0,s.jsx)(Y.Z,{className:"h-4 w-4 mr-2"}),"Notas (opcional)"]}),(0,s.jsx)(W,{id:"notes",value:i.notes,onChange:e=>f("notes",e.target.value),placeholder:"Notas adicionales sobre la cita...",rows:3})]}),(0,s.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,s.jsx)(p,{type:"submit",disabled:d,className:"flex-1",children:d?"Guardando...":a?"Actualizar":"Crear Cita"}),(0,s.jsx)(p,{type:"button",variant:"outline",onClick:n,disabled:d,children:"Cancelar"})]})]})})]})}var K=t(9121),$=t(4289),X=t(3430),q=t(3247),Q=t(740),ee=t(5868),ea=t(8930),et=t(394);let es=et.fC,er=et.xz,en=et.h_,ei=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(et.aV,{className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:a})});ei.displayName=et.aV.displayName;let el=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsxs)(en,{children:[(0,s.jsx)(ei,{}),(0,s.jsx)(et.VY,{ref:a,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});el.displayName=et.VY.displayName;let eo=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};eo.displayName="AlertDialogHeader";let ec=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};ec.displayName="AlertDialogFooter";let ed=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(et.Dx,{ref:a,className:(0,f.cn)("text-lg font-semibold",t),...r})});ed.displayName=et.Dx.displayName;let em=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(et.dk,{ref:a,className:(0,f.cn)("text-sm text-muted-foreground",t),...r})});em.displayName=et.dk.displayName;let eu=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(et.aU,{ref:a,className:(0,f.cn)(h(),t),...r})});eu.displayName=et.aU.displayName;let ex=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(et.$j,{ref:a,className:(0,f.cn)(h({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});ex.displayName=et.$j.displayName;var ef=t(7265),eh=t(875),ep=t(2135),eg=t(401);let ej=ef.fC;ef.ZA;let eN=ef.B4,ey=r.forwardRef((e,a)=>{let{className:t,children:r,...n}=e;return(0,s.jsxs)(ef.xz,{ref:a,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,s.jsx)(ef.JO,{asChild:!0,children:(0,s.jsx)(eh.Z,{className:"h-4 w-4 opacity-50"})})]})});ey.displayName=ef.xz.displayName;let ev=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(ef.u_,{ref:a,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(ep.Z,{className:"h-4 w-4"})})});ev.displayName=ef.u_.displayName;let eb=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(ef.$G,{ref:a,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(eh.Z,{className:"h-4 w-4"})})});eb.displayName=ef.$G.displayName;let ew=r.forwardRef((e,a)=>{let{className:t,children:r,position:n="popper",...i}=e;return(0,s.jsx)(ef.h_,{children:(0,s.jsxs)(ef.VY,{ref:a,className:(0,f.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[(0,s.jsx)(ev,{}),(0,s.jsx)(ef.l_,{className:(0,f.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(eb,{})]})})});ew.displayName=ef.VY.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(ef.__,{ref:a,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=ef.__.displayName;let eE=r.forwardRef((e,a)=>{let{className:t,children:r,...n}=e;return(0,s.jsxs)(ef.ck,{ref:a,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(ef.wU,{children:(0,s.jsx)(eg.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(ef.eT,{children:r})]})});function eC(e){let{appointments:a,onEdit:t,onDelete:n}=e,[i,l]=(0,r.useState)(""),[o,c]=(0,r.useState)("all"),d=(e=>{let a=e;i&&(a=a.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.phone.includes(i)));let t=new Date;(0,K.E)(t,1);let s=(0,K.E)(t,7);switch(o){case"today":a=a.filter(e=>{let a=(0,D.D)(e.date);return(0,R.WU)(a,"yyyy-MM-dd")===(0,R.WU)(t,"yyyy-MM-dd")});break;case"upcoming":a=a.filter(e=>{let a=(0,D.D)(e.date);return(0,$.A)(a,t)&&(0,X.R)(a,s)});break;case"past":a=a.filter(e=>{let a=(0,D.D)(e.date);return(0,X.R)(a,t)})}return a.sort((e,a)=>{let t=(0,D.D)(e.date),s=(0,D.D)(a.date);return t.getTime()-s.getTime()})})(a),m=e=>{let a=(0,D.D)("".concat(e.date,"T").concat(e.time)),t=new Date;return(0,X.R)(a,t)?{status:"past",label:"Pasada",variant:"secondary"}:(0,R.WU)(a,"yyyy-MM-dd")===(0,R.WU)(t,"yyyy-MM-dd")?{status:"today",label:"Hoy",variant:"default"}:{status:"upcoming",label:"Pr\xf3xima",variant:"outline"}};return(0,s.jsxs)(g,{children:[(0,s.jsxs)(j,{children:[(0,s.jsxs)(N,{className:"flex items-center",children:[(0,s.jsx)(w.Z,{className:"h-5 w-5 mr-2"}),"Lista de Citas (",d.length,")"]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(q.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(L,{placeholder:"Buscar por nombre, email o tel\xe9fono...",value:i,onChange:e=>l(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(ej,{value:o,onValueChange:c,children:[(0,s.jsxs)(ey,{className:"w-full sm:w-48",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(eN,{})]}),(0,s.jsxs)(ew,{children:[(0,s.jsx)(eE,{value:"all",children:"Todas las citas"}),(0,s.jsx)(eE,{value:"today",children:"Hoy"}),(0,s.jsx)(eE,{value:"upcoming",children:"Pr\xf3ximas"}),(0,s.jsx)(eE,{value:"past",children:"Pasadas"})]})]})]})]}),(0,s.jsx)(v,{children:0===d.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(w.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:i||"all"!==o?"No se encontraron citas con los filtros aplicados":"No hay citas programadas"})]}):(0,s.jsx)("div",{className:"space-y-4",children:d.map(e=>{let{status:a,label:r,variant:i}=m(e);return(0,s.jsxs)("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(G.Z,{className:"h-5 w-5 text-blue-600"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-lg",children:e.name}),(0,s.jsx)(A,{variant:i,className:"mt-1",children:r})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(p,{variant:"outline",size:"sm",onClick:()=>t(e),children:(0,s.jsx)(ee.Z,{className:"h-4 w-4"})}),(0,s.jsxs)(es,{children:[(0,s.jsx)(er,{asChild:!0,children:(0,s.jsx)(p,{variant:"outline",size:"sm",children:(0,s.jsx)(ea.Z,{className:"h-4 w-4"})})}),(0,s.jsxs)(el,{children:[(0,s.jsxs)(eo,{children:[(0,s.jsx)(ed,{children:"\xbfEliminar cita?"}),(0,s.jsxs)(em,{children:["Esta acci\xf3n no se puede deshacer. Se eliminar\xe1 permanentemente la cita de"," ",e.name,"."]})]}),(0,s.jsxs)(ec,{children:[(0,s.jsx)(ex,{children:"Cancelar"}),(0,s.jsx)(eu,{onClick:()=>n(e.id),className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,s.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),e.email]}),(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,s.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),e.phone]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,s.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),(0,R.WU)((0,D.D)(e.date),"d 'de' MMMM, yyyy",{locale:M.es})]}),(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,s.jsx)(I.Z,{className:"h-4 w-4 mr-2"}),e.time]})]})]}),e.notes&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.notes})})]},e.id)})})})]})}eE.displayName=ef.ck.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(ef.Z0,{ref:a,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=ef.Z0.displayName;var eT=t(7312);let eS=eT.fC,ek=eT.xz,e_=r.forwardRef((e,a)=>{let{className:t,align:r="center",sideOffset:n=4,...i}=e;return(0,s.jsx)(eT.h_,{children:(0,s.jsx)(eT.VY,{ref:a,align:r,sideOffset:n,className:(0,f.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});e_.displayName=eT.VY.displayName;var eZ=t(4766),eA=t(817),ez=t(4780),eD=t(6638);function eR(e){let{appointments:a}=e,[t,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(0);(0,r.useEffect)(()=>{o()},[a]);let o=()=>{let e=new Date,t=[];a.forEach(a=>{let s=(0,D.D)("".concat(a.date,"T").concat(a.time));(0,eA.z)(s)&&(0,$.A)(s,e)&&t.push({id:"today-".concat(a.id),type:"reminder",title:"Cita hoy",message:"Tienes una cita con ".concat(a.name," a las ").concat(a.time),appointment:a,time:s}),(0,ez.P)(s)&&t.push({id:"tomorrow-".concat(a.id),type:"upcoming",title:"Cita ma\xf1ana",message:"Tienes una cita con ".concat(a.name," ma\xf1ana a las ").concat(a.time),appointment:a,time:s});let r=(0,eD.T)(s,-1);(0,$.A)(e,r)&&(0,X.R)(e,s)&&t.push({id:"hour-".concat(a.id),type:"reminder",title:"Cita en 1 hora",message:"Tu cita con ".concat(a.name," es en aproximadamente 1 hora"),appointment:a,time:s})}),t.sort((e,a)=>e.time.getTime()-a.time.getTime()),n(t),l(t.length)};return(0,s.jsxs)(eS,{children:[(0,s.jsx)(ek,{asChild:!0,children:(0,s.jsxs)(p,{variant:"outline",size:"sm",className:"relative bg-transparent",children:[(0,s.jsx)(eZ.Z,{className:"h-4 w-4"}),i>0&&(0,s.jsx)(A,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 flex items-center justify-center p-0 text-xs",children:i>9?"9+":i})]})}),(0,s.jsx)(e_,{className:"w-80",align:"end",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Notificaciones"}),i>0&&(0,s.jsx)(p,{variant:"ghost",size:"sm",onClick:()=>{l(0)},className:"text-xs",children:"Marcar como le\xeddas"})]}),0===t.length?(0,s.jsxs)("div",{className:"text-center py-6",children:[(0,s.jsx)(eZ.Z,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay notificaciones nuevas"})]}):(0,s.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.map(e=>(0,s.jsx)("div",{className:"p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat("reminder"===e.type?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"),children:"reminder"===e.type?(0,s.jsx)(I.Z,{className:"h-4 w-4"}):(0,s.jsx)(w.Z,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:(0,R.WU)(e.time,"d 'de' MMMM 'a las' HH:mm",{locale:M.es})})]})]})},e.id))})]})})]})}var eM=t(1312);let eI=eM.fC,eO=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(eM.aV,{ref:a,className:(0,f.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});eO.displayName=eM.aV.displayName;let eV=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(eM.xz,{ref:a,className:(0,f.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});eV.displayName=eM.xz.displayName;let eU=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(eM.VY,{ref:a,className:(0,f.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});eU.displayName=eM.VY.displayName;var eL=t(9397),eH=t(7692),eP=t(7586);class eF{async getAccessToken(){let e=d.currentUser;if(!e)return null;try{return await e.getIdToken()}catch(e){return console.error("Error getting access token:",e),null}}async createEvent(e){let a=await this.getAccessToken();if(!a)throw Error("No access token available");try{let t=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events",{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}catch(e){throw console.error("Error creating calendar event:",e),e}}async updateEvent(e,a){let t=await this.getAccessToken();if(!t)throw Error("No access token available");try{let s=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events/".concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));return await s.json()}catch(e){throw console.error("Error updating calendar event:",e),e}}async deleteEvent(e){let a=await this.getAccessToken();if(!a)throw Error("No access token available");try{let t=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status))}catch(e){throw console.error("Error deleting calendar event:",e),e}}}let eW=new eF;class eB{async createAppointment(e){try{let a=await (0,o.ET)((0,o.hJ)(m,this.collectionName),{...e,createdAt:o.EK.now(),updatedAt:o.EK.now()});try{await eW.createEvent({summary:"Cita con ".concat(e.name),description:"Email: ".concat(e.email,"\nTel\xe9fono: ").concat(e.phone,"\nNotas: ").concat(e.notes||"Sin notas"),start:{dateTime:"".concat(e.date,"T").concat(e.time,":00"),timeZone:"Europe/Madrid"},end:{dateTime:"".concat(e.date,"T").concat(this.addHour(e.time),":00"),timeZone:"Europe/Madrid"},attendees:[{email:e.email}]})}catch(e){console.warn("No se pudo crear el evento en Google Calendar:",e)}return a.id}catch(e){throw console.error("Error al crear cita:",e),Error("No se pudo crear la cita")}}async updateAppointment(e,a){try{let t=(0,o.JU)(m,this.collectionName,e);await (0,o.r7)(t,{...a,updatedAt:o.EK.now()})}catch(e){throw console.error("Error al actualizar cita:",e),Error("No se pudo actualizar la cita")}}async deleteAppointment(e){try{let a=(0,o.JU)(m,this.collectionName,e);await (0,o.oe)(a)}catch(e){throw console.error("Error al eliminar cita:",e),Error("No se pudo eliminar la cita")}}async getAppointments(e){try{let a=(0,o.IO)((0,o.hJ)(m,this.collectionName),(0,o.ar)("userId","==",e),(0,o.Xo)("date","asc")),t=await (0,o.PL)(a),s=[];return t.forEach(e=>{s.push({id:e.id,...e.data()})}),s}catch(e){throw console.error("Error al obtener citas:",e),Error("No se pudieron cargar las citas")}}addHour(e){let[a,t]=e.split(":").map(Number);return"".concat(((a+1)%24).toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}constructor(){this.collectionName="appointments"}}let eG=new eB;function eY(){let[e]=(0,n.F_)(d),[a,t]=(0,r.useState)([]),[i,o]=(0,r.useState)(new Date),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)(!1),[f,h]=(0,r.useState)(!0),{toast:y}=(0,b.pm)();(0,r.useEffect)(()=>{e&&E()},[e]);let E=async()=>{if(e)try{h(!0);let a=await eG.getAppointments(e.uid);t(a)}catch(e){console.error("Error al cargar citas:",e),y({title:"Error",description:"No se pudieron cargar las citas.",variant:"destructive"})}finally{h(!1)}},C=async a=>{if(e)try{c?(await eG.updateAppointment(c.id,a),y({title:"Cita actualizada",description:"La cita se ha actualizado correctamente."})):(await eG.createAppointment({...a,userId:e.uid}),y({title:"Cita creada",description:"La cita se ha creado correctamente."})),await E(),x(!1),m(null)}catch(e){console.error("Error al guardar cita:",e),y({title:"Error",description:"No se pudo guardar la cita.",variant:"destructive"})}},T=async e=>{try{await eG.deleteAppointment(e),await E(),y({title:"Cita eliminada",description:"La cita se ha eliminado correctamente."})}catch(e){console.error("Error al eliminar cita:",e),y({title:"Error",description:"No se pudo eliminar la cita.",variant:"destructive"})}},S=e=>{m(e),x(!0)},k=async()=>{try{await (0,l.w7)(d)}catch(e){console.error("Error al cerrar sesi\xf3n:",e)}};return f?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{children:"Cargando citas..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(w.Z,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Gestor de Citas"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(eR,{appointments:a}),(0,s.jsxs)(p,{onClick:()=>x(!0),size:"sm",className:"hidden sm:flex",children:[(0,s.jsx)(eL.Z,{className:"h-4 w-4 mr-2"}),"Nueva Cita"]}),(0,s.jsxs)(p,{onClick:k,variant:"outline",size:"sm",children:[(0,s.jsx)(eH.Z,{className:"h-4 w-4 mr-2"}),"Salir"]})]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)(eI,{defaultValue:"calendar",className:"w-full",children:[(0,s.jsxs)(eO,{className:"grid w-full grid-cols-2",children:[(0,s.jsxs)(eV,{value:"calendar",children:[(0,s.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Calendario"]}),(0,s.jsxs)(eV,{value:"list",children:[(0,s.jsx)(eP.Z,{className:"h-4 w-4 mr-2"}),"Lista"]})]}),(0,s.jsx)(eU,{value:"calendar",className:"mt-6",children:(0,s.jsxs)(g,{children:[(0,s.jsx)(j,{children:(0,s.jsx)(N,{children:"Calendario de Citas"})}),(0,s.jsx)(v,{children:(0,s.jsx)(U,{appointments:a,selectedDate:i,onDateSelect:o,onAppointmentClick:S})})]})}),(0,s.jsx)(eU,{value:"list",className:"mt-6",children:(0,s.jsx)(eC,{appointments:a,onEdit:S,onDelete:T})})]})}),(0,s.jsxs)("div",{className:"lg:col-span-1",children:[u&&(0,s.jsx)(J,{appointment:c,onSave:C,onCancel:()=>{x(!1),m(null)}}),(0,s.jsxs)(p,{onClick:()=>x(!0),className:"w-full mb-6 sm:hidden",children:[(0,s.jsx)(eL.Z,{className:"h-4 w-4 mr-2"}),"Nueva Cita"]})]})]})})]})}var eJ=t(1817);function eK(){let[e,a]=(0,n.F_)(d),[t,i]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{i(!0)},[]),!t||a)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(eJ.Z,{className:"h-8 w-8 animate-spin"})}):e?(0,s.jsx)(eY,{}):(0,s.jsx)(C,{})}},5153:function(e,a,t){"use strict";t.d(a,{pm:function(){return u}});var s=t(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let a=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,a)},l=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=a;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function m(e){let{...a}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,a]=s.useState(c);return s.useEffect(()=>(o.push(a),()=>{let e=o.indexOf(a);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},4508:function(e,a,t){"use strict";t.d(a,{cn:function(){return n}});var s=t(1994),r=t(3335);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,r.m6)((0,s.W)(a))}}},function(e){e.O(0,[15,609,259,783,971,117,744],function(){return e(e.s=5993)}),_N_E=e.O()}]);